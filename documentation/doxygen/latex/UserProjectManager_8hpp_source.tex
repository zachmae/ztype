\hypertarget{UserProjectManager_8hpp_source}{}\doxysection{User\+Project\+Manager.\+hpp}
\label{UserProjectManager_8hpp_source}\index{/home/Teyi/Epitech/Semestre5/CPP/rtype/src/User/UserProjectManager.hpp@{/home/Teyi/Epitech/Semestre5/CPP/rtype/src/User/UserProjectManager.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{** EPITECH PROJECT, 2022}}
\DoxyCodeLine{3 \textcolor{comment}{** B-\/CPP-\/500-\/PAR-\/5-\/1-\/rtype-\/zacharie.lawson}}
\DoxyCodeLine{4 \textcolor{comment}{** File description:}}
\DoxyCodeLine{5 \textcolor{comment}{** ProjectManager}}
\DoxyCodeLine{6 \textcolor{comment}{*/}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#ifndef USER\_PROJECTMANAGER\_HPP\_}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#define USER\_PROJECTMANAGER\_HPP\_}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{12 \textcolor{comment}{//Std}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <tuple>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <type\_traits>} \textcolor{comment}{//std::is\_same\_v}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{comment}{//sfml}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <SFML/Window.hpp>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <SFML/Graphics.hpp>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <SFML/Audio.hpp>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <SFML/System.hpp>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <SFML/Network.hpp>}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{comment}{//json}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <nlohmann/json.hpp>}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{comment}{//SceneManager}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include "{}../SceneManager/SceneManager.hpp"{}}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include "{}../SceneManager/SceneComponentManager.hpp"{}}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{comment}{//ProjectManager}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include "{}../ProjectManager/ProjectManager.hpp"{}}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{comment}{//Manager}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#include "{}../SpriteManager.hpp"{}}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#include "{}../MusicManager.hpp"{}}}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#include "{}../AudioManager.hpp"{}}}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#include "{}../MusicManager.hpp"{}}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{preprocessor}{\#include "{}Globals.hpp"{}}}
\DoxyCodeLine{41 }
\DoxyCodeLine{47 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceProject}{Project}} \{}
\DoxyCodeLine{48 }
\DoxyCodeLine{49     \textcolor{keyword}{using }json = nlohmann::json;}
\DoxyCodeLine{50     \textcolor{keyword}{using }Window\_ref = sf::RenderWindow \&;}
\DoxyCodeLine{51     \textcolor{keyword}{using }Event\_ref = sf::Event \&;}
\DoxyCodeLine{52     \textcolor{keyword}{using }Music\_ref = sf::Music \&;}
\DoxyCodeLine{53     \textcolor{keyword}{using }Sound\_ref = sf::Sound \&;}
\DoxyCodeLine{54 }
\DoxyCodeLine{60     \textcolor{keyword}{class }\mbox{\hyperlink{classProject_1_1UserProjectManager}{UserProjectManager}} final : \textcolor{keyword}{public} \mbox{\hyperlink{classProject_1_1ProjectManager}{ProjectManager}} \{}
\DoxyCodeLine{61         \textcolor{keyword}{public}:}
\DoxyCodeLine{62 }
\DoxyCodeLine{68             \mbox{\hyperlink{classProject_1_1UserProjectManager_ae385d36cd51702002d3e9aa4e2fe4e83}{UserProjectManager}}(std::string jsonfile)}
\DoxyCodeLine{69             : \mbox{\hyperlink{classProject_1_1ProjectManager}{ProjectManager}}(jsonfile), \_window(CreateWindow(jsonfile)), \_sm(), \_am(), \_mm()}
\DoxyCodeLine{70             \{}
\DoxyCodeLine{71                 \mbox{\hyperlink{structProject_1_1ProjectManager_1_1config__extractor}{config\_extractor<scene\_config::components\_list>::function}}(\_ecs); \textcolor{comment}{//sys}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73                 json file = json::parse(std::ifstream(jsonfile.c\_str()));}
\DoxyCodeLine{74                 InitWindow(file);}
\DoxyCodeLine{75                 InitSprites(file);}
\DoxyCodeLine{76                 InitSounds(file);}
\DoxyCodeLine{77                 InitScenes(file);}
\DoxyCodeLine{78             \};}
\DoxyCodeLine{79 }
\DoxyCodeLine{84             \mbox{\hyperlink{classProject_1_1UserProjectManager_a189abcb3e7b727ada9c58e254292e329}{\string~UserProjectManager}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{85 }
\DoxyCodeLine{93             \textcolor{keywordtype}{int} \mbox{\hyperlink{classProject_1_1UserProjectManager_a93dbd0b3b00151149d62b26fdb36c57d}{Start}}(std::string \textcolor{keyword}{const} \&ip, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} port)}
\DoxyCodeLine{94             \{}
\DoxyCodeLine{95                 \_userManager.\mbox{\hyperlink{classUser_1_1UserManager_aea31a0133be73187b782ec17e4cef0f3}{InitScene}}(\_ecs, \_sm, \_am, \_mm, \_scenes);}
\DoxyCodeLine{96                 \textcolor{keywordflow}{while} (\_window.isOpen()) \{ \textcolor{comment}{// run the program as long as the window is open}}
\DoxyCodeLine{97                     \textcolor{comment}{// check all the window's events that were triggered since the last iteration of the loop}}
\DoxyCodeLine{98                     \textcolor{keywordflow}{while} (\_window.pollEvent(\_event)) \{}
\DoxyCodeLine{99                         \textcolor{comment}{// "{}close requested"{} event: we close the window}}
\DoxyCodeLine{100                         \textcolor{keywordflow}{if} (\_event.type == sf::Event::Closed) \{}
\DoxyCodeLine{101                             \_userManager.\mbox{\hyperlink{classUser_1_1UserManager_a575672a372f0f46a18074c45c2005390}{Close}}();}
\DoxyCodeLine{102                             \_window.close();}
\DoxyCodeLine{103                             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{104                         \}}
\DoxyCodeLine{105                         \_userManager.\mbox{\hyperlink{classUser_1_1UserManager_a14e6381225eeb1e1c0dca9a17f3191d8}{UpdateScene}}(\_ecs, \_scenes, \_window, \_event);}
\DoxyCodeLine{106                         \_userManager.\mbox{\hyperlink{classUser_1_1UserManager_a8f65c1c441499a173aaaefb94c3eec6a}{UpdateEventSystem}}(\_ecs, \_event, \_window, \_sm, \_am);}
\DoxyCodeLine{107                     \}}
\DoxyCodeLine{108                     \_userManager.\mbox{\hyperlink{classUser_1_1UserManager_a1ffdaf90136d5d535471b6e86abe2899}{UpdateClient}}(\_ecs, \_scenes, \_sm, \_am);}
\DoxyCodeLine{109                     \_window.clear();}
\DoxyCodeLine{110                     \_userManager.\mbox{\hyperlink{classUser_1_1UserManager_af3e96c15c8da418dfdf5e9f2e9a4aa1a}{UpdateWindowSystem}}(\_ecs, \_scenes, \_window, \_sm);}
\DoxyCodeLine{111                     \_window.display();}
\DoxyCodeLine{112                     \_userManager.\mbox{\hyperlink{classUser_1_1UserManager_a4e73f7826dad6fe2784383307e0e4751}{UpdatePostWindowSystem}}(\_ecs, \_scenes, \_window, \_am);}
\DoxyCodeLine{113                 \}}
\DoxyCodeLine{114                 \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{115             \};}
\DoxyCodeLine{116 }
\DoxyCodeLine{118 }
\DoxyCodeLine{119         \textcolor{keyword}{private}:}
\DoxyCodeLine{120 }
\DoxyCodeLine{127             sf::RenderWindow CreateWindow(std::string jsonfile)}
\DoxyCodeLine{128             \{}
\DoxyCodeLine{129                 std::ifstream ifs(jsonfile.c\_str());}
\DoxyCodeLine{130 }
\DoxyCodeLine{131                 \textcolor{keywordflow}{if} (ifs.good()) \{}
\DoxyCodeLine{132                     json file = json::parse(ifs);}
\DoxyCodeLine{133 }
\DoxyCodeLine{134                     \textcolor{keywordflow}{return} sf::RenderWindow(sf::VideoMode(file[\textcolor{stringliteral}{"{}window"{}}][\textcolor{stringliteral}{"{}width"{}}], file[\textcolor{stringliteral}{"{}window"{}}][\textcolor{stringliteral}{"{}height"{}}]),}
\DoxyCodeLine{135                             std::string(file[\textcolor{stringliteral}{"{}window"{}}][\textcolor{stringliteral}{"{}title"{}}]) );}
\DoxyCodeLine{136                 \}}
\DoxyCodeLine{137                 std::cerr << \textcolor{stringliteral}{"{}Error: "{}} << jsonfile << \textcolor{stringliteral}{"{} not found"{}} << std::endl;}
\DoxyCodeLine{138                 exit(84);}
\DoxyCodeLine{139             \}}
\DoxyCodeLine{140 }
\DoxyCodeLine{141             \textcolor{keywordtype}{void} InitWindow(json file)}
\DoxyCodeLine{142             \{}
\DoxyCodeLine{143                 \_window.setFramerateLimit(file[\textcolor{stringliteral}{"{}window"{}}][\textcolor{stringliteral}{"{}framerate-\/limit"{}}]);}
\DoxyCodeLine{144             \}}
\DoxyCodeLine{145 }
\DoxyCodeLine{151             \textcolor{keywordtype}{void} InitScenes(json file)}
\DoxyCodeLine{152             \{}
\DoxyCodeLine{153                 std::cout << file[\textcolor{stringliteral}{"{}scenes-\/path"{}}] << std::endl;}
\DoxyCodeLine{154                 std::ifstream ifs(\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(file[\textcolor{stringliteral}{"{}scenes-\/path"{}}]));}
\DoxyCodeLine{155                 json fileScene;}
\DoxyCodeLine{156                 \textcolor{keywordtype}{int} sceneIds = 0;}
\DoxyCodeLine{157 }
\DoxyCodeLine{158                 \textcolor{keywordflow}{if} (ifs.good()) \{}
\DoxyCodeLine{159                     fileScene = json::parse(ifs);}
\DoxyCodeLine{160                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&it : fileScene[\textcolor{stringliteral}{"{}scenes"{}}]) \{}
\DoxyCodeLine{161                         std::cout << it[\textcolor{stringliteral}{"{}name"{}}] << it[\textcolor{stringliteral}{"{}path"{}}] << std::endl;}
\DoxyCodeLine{162                         \_scenes.\mbox{\hyperlink{classSceneManager_a7fd266f0cfa89d0a5b1deb2196f29b35}{Add}}(it[\textcolor{stringliteral}{"{}name"{}}], \mbox{\hyperlink{classScene}{Scene}}(\_ecs, sceneIds, it[\textcolor{stringliteral}{"{}path"{}}]));}
\DoxyCodeLine{163                         ++sceneIds;}
\DoxyCodeLine{164                     \}}
\DoxyCodeLine{165                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{166                     std::cout << file[\textcolor{stringliteral}{"{}scene-\/path"{}}] << \textcolor{stringliteral}{"{} is missing"{}} << std::endl;}
\DoxyCodeLine{167                     exit(84);}
\DoxyCodeLine{168                 \}}
\DoxyCodeLine{169             \}}
\DoxyCodeLine{170 }
\DoxyCodeLine{176             \textcolor{keywordtype}{void} InitSprites(json file)}
\DoxyCodeLine{177             \{}
\DoxyCodeLine{178                 std::cout << file[\textcolor{stringliteral}{"{}sprites-\/path"{}}] << std::endl;}
\DoxyCodeLine{179                 std::ifstream ifs(\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(file[\textcolor{stringliteral}{"{}sprites-\/path"{}}]));}
\DoxyCodeLine{180                 json fileSprite;}
\DoxyCodeLine{181 }
\DoxyCodeLine{182                 \textcolor{keywordflow}{if} (ifs.good()) \{ \textcolor{comment}{//check if file exist}}
\DoxyCodeLine{183                     fileSprite = json::parse(ifs);}
\DoxyCodeLine{184                     Globals::debug\_mode =  fileSprite[\textcolor{stringliteral}{"{}debug"{}}];}
\DoxyCodeLine{185                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&it : fileSprite[\textcolor{stringliteral}{"{}sprites"{}}]) \{ \textcolor{comment}{//get each sprite}}
\DoxyCodeLine{186                         std::cout << \textcolor{stringliteral}{"{}load: "{}} << it[\textcolor{stringliteral}{"{}name"{}}] << it[\textcolor{stringliteral}{"{}path"{}}] << std::endl; \textcolor{comment}{//debug}}
\DoxyCodeLine{187                         \_sm.\mbox{\hyperlink{group__StorageManager_gaa0cdd9e7e602bef6f884c7b79a1d4749}{Add}}(it[\textcolor{stringliteral}{"{}name"{}}], it[\textcolor{stringliteral}{"{}path"{}}]); \textcolor{comment}{// add sprite to sprite manager}}
\DoxyCodeLine{188                     \}}
\DoxyCodeLine{189                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{190                     std::cout << \textcolor{stringliteral}{"{}sprite-\/path missing"{}} << std::endl;}
\DoxyCodeLine{191                     exit(84);}
\DoxyCodeLine{192                 \}}
\DoxyCodeLine{193             \}}
\DoxyCodeLine{194 }
\DoxyCodeLine{200             \textcolor{keywordtype}{void} InitSounds(json file)}
\DoxyCodeLine{201             \{}
\DoxyCodeLine{202                 std::cout << file[\textcolor{stringliteral}{"{}sounds-\/path"{}}] << std::endl;}
\DoxyCodeLine{203                 std::ifstream ifs(\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(file[\textcolor{stringliteral}{"{}sounds-\/path"{}}]));}
\DoxyCodeLine{204                 json fileSound;}
\DoxyCodeLine{205 }
\DoxyCodeLine{206                 \textcolor{keywordflow}{if} (ifs.good()) \{ \textcolor{comment}{//check if file exist}}
\DoxyCodeLine{207                     fileSound = json::parse(ifs);}
\DoxyCodeLine{208                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&it : fileSound[\textcolor{stringliteral}{"{}musics"{}}]) \{ \textcolor{comment}{//get each music}}
\DoxyCodeLine{209                         std::cout << \textcolor{stringliteral}{"{}load: "{}} << it[\textcolor{stringliteral}{"{}name"{}}] << it[\textcolor{stringliteral}{"{}path"{}}] << std::endl; \textcolor{comment}{//debug}}
\DoxyCodeLine{210                         \_mm.\mbox{\hyperlink{group__StorageManager_ga54b3aa54a92b36216249fe3c204624b8}{Add}}(it[\textcolor{stringliteral}{"{}name"{}}], it[\textcolor{stringliteral}{"{}path"{}}]); \textcolor{comment}{// add musics to music manager}}
\DoxyCodeLine{211                     \}}
\DoxyCodeLine{212                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&it : fileSound[\textcolor{stringliteral}{"{}audios"{}}]) \{ \textcolor{comment}{//get each audio}}
\DoxyCodeLine{213                         std::cout << \textcolor{stringliteral}{"{}load: "{}} << it[\textcolor{stringliteral}{"{}name"{}}] << it[\textcolor{stringliteral}{"{}path"{}}] << std::endl; \textcolor{comment}{//debug}}
\DoxyCodeLine{214                         \_am.\mbox{\hyperlink{group__StorageManager_gab236af81a564c0ddf330dbb153da09a4}{Add}}(it[\textcolor{stringliteral}{"{}name"{}}], it[\textcolor{stringliteral}{"{}path"{}}]); \textcolor{comment}{// add audio to audio manager}}
\DoxyCodeLine{215                     \}}
\DoxyCodeLine{216                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{217                     std::cout << \textcolor{stringliteral}{"{}sound-\/path missing"{}} << std::endl;}
\DoxyCodeLine{218                     exit(84);}
\DoxyCodeLine{219                 \}}
\DoxyCodeLine{220             \}}
\DoxyCodeLine{221 }
\DoxyCodeLine{222 }
\DoxyCodeLine{223         \textcolor{keyword}{private}:}
\DoxyCodeLine{224 }
\DoxyCodeLine{225             \textcolor{comment}{//sfml}}
\DoxyCodeLine{226             sf::RenderWindow \_window;}
\DoxyCodeLine{227             sf::Event \_event;}
\DoxyCodeLine{228 }
\DoxyCodeLine{229             \textcolor{comment}{//manager}}
\DoxyCodeLine{230             \mbox{\hyperlink{classSceneManager}{SceneManager<std::string>}} \_scenes;}
\DoxyCodeLine{231             \mbox{\hyperlink{classSpriteManager}{SpriteManager<std::string>}} \_sm;}
\DoxyCodeLine{232             \mbox{\hyperlink{classMusicManager}{MusicManager<std::string>}} \_mm;}
\DoxyCodeLine{233             \mbox{\hyperlink{classAudioManager}{AudioManager<std::string>}} \_am;}
\DoxyCodeLine{234         \textcolor{keyword}{public}:}
\DoxyCodeLine{235     \};}
\DoxyCodeLine{236 }
\DoxyCodeLine{237 \};}
\DoxyCodeLine{238 }
\DoxyCodeLine{239 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* !PROJECTMANAGER\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
